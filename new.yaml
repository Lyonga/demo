{
   "Version": "2012-10-17",
   "Statement": [
      {
         "Sid": "EnforceEC2IMDSv2",
         "Effect":"Deny",
         "Action":"ec2:RunInstances",
         "Resource":"arn:aws:ec2:*:*:instance/*",
         "Condition":{
            "StringNotEquals":{
               "ec2:MetadataHttpTokens":"required"   ##############
            }
         }
      },
      {
         "Effect":"Deny",
         "Action":"ec2:RunInstances",
         "Resource":"arn:aws:ec2:*:*:instance/*",
         "Condition":{
            "NumericGreaterThan":{
               "ec2:MetadataHttpPutResponseHopLimit":"3"
            }
         }
      },
      {
         "Effect":"Deny",
         "Action":"*",
         "Resource":"*",
         "Condition":{
            "NumericLessThan":{
               "ec2:RoleDelivery":"2.0"
            }
         }
      },
      {
         "Effect":"Deny",
         "Action":"ec2:ModifyInstanceMetadataOptions",
         "Resource":"*"
      },
      {
         "Sid": "PreventCreateUnencryptedVolume",
         "Effect": "Deny",
         "Action": "ec2:CreateVolume",
         "Resource": "*",
         "Condition": {
           "Bool": {
             "ec2:Encrypted": "false"
           }
         }
       },
       {
         "Sid": "PreventEc2MountUnencryptedVolume",
         "Effect": "Deny",
         "Action": "ec2:RunInstances",
         "Resource": "arn:aws:ec2:*:*:volume/*",
         "Condition": {
           "Bool": {
             "ec2:Encrypted": "false"
            }
          }
       },
      { 
         "Sid": "DenyDisableEbsEncryptionByDefault",    
         "Effect": "Deny", 
         "Action": [ 
               "ec2:DisableEbsEncryptionByDefault" 
         ], 
         "Resource": "*" 
      },
      {
         "Sid": "DenyCreationAndAttachmentOfNonGP3Volumes",
         "Effect": "Deny",
         "Action": [
         "ec2:AttachVolume",
         "ec2:CreateVolume",
         "ec2:RunInstances"
         ],
         "Resource": "arn:aws:ec2:*:*:volume/*",
         "Condition": {
         "StringNotEquals": {
            "ec2:VolumeType": "gp3"
         }
         }
      }
   ]
 }
 
